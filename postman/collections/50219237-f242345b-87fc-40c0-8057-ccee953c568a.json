{
	"info": {
		"_postman_id": "50219237-f242345b-87fc-40c0-8057-ccee953c568a",
		"name": "Nimap API Testing",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login - Valid Credentials",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "7889b481-97d3-4751-b741-36504c4b5a15",
								"exec": [
									"// Test 1: Check if login was successful\r",
									"pm.test(\"Login successful - Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"// Test 2: Check if response contains success flag\r",
									"pm.test(\"Response contains success flag\", function () {\r",
									"    var jsonData = pm.response.json();\r",
									"    pm.expect(jsonData.success).to.be.true;\r",
									"});\r",
									"\r",
									"// Parse the JSON response\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"// CORRECTED: Extract referralToken from response and save to environment\r",
									"if (jsonData.referralToken) {\r",
									"    // Save the referralToken as authToken for reuse\r",
									"    pm.environment.set(\"authToken\", jsonData.referralToken);\r",
									"    console.log(\"✅ Token saved successfully:\", jsonData.referralToken);\r",
									"} else if (jsonData.token && jsonData.token !== \"\") {\r",
									"    // Fallback: If token field has a value\r",
									"    pm.environment.set(\"authToken\", jsonData.token);\r",
									"    console.log(\"✅ Token saved successfully:\", jsonData.token);\r",
									"} else if (jsonData.data && jsonData.data.token) {\r",
									"    // If token is nested inside 'data' object\r",
									"    pm.environment.set(\"authToken\", jsonData.data.token);\r",
									"    console.log(\"✅ Token saved successfully:\", jsonData.data.token);\r",
									"} else {\r",
									"    console.log(\"⚠️ No token found in response!\");\r",
									"}\r",
									"\r",
									"// Test 3: Verify token was saved to environment\r",
									"pm.test(\"Auth token saved to environment\", function () {\r",
									"    var savedToken = pm.environment.get(\"authToken\");\r",
									"    pm.expect(savedToken).to.not.be.undefined;\r",
									"    pm.expect(savedToken).to.not.be.empty;\r",
									"});\r",
									"\r",
									"// Test 4: Verify userId is present\r",
									"pm.test(\"Response contains userId\", function () {\r",
									"    pm.expect(jsonData.userId).to.exist;\r",
									"    pm.expect(jsonData.userId).to.equal(1336);\r",
									"});\r",
									"\r",
									"// Optional: Save other useful data\r",
									"pm.environment.set(\"userId\", jsonData.userId);\r",
									"pm.environment.set(\"companyId\", jsonData.companyId);\r",
									"console.log(\"✅ UserId saved:\", jsonData.userId);\r",
									"console.log(\"✅ CompanyId saved:\", jsonData.companyId);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50219237-67767696-9527-45ed-be55-947430108984",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json; charset=utf-8",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json, text/plain, */*",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"username\": \"{{username}}\",\r\n    \"password\": \"{{password}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/api/account/authenticate",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"api",
								"account",
								"authenticate"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login - Invalid Credentials",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "7889b481-97d3-4751-b741-36504c4b5a15",
								"exec": [
									"// Test: Check if status code is 401 or 400\r",
									"     pm.test(\"Status code is 401 Unauthorized or 400 Bad Request\", function () {\r",
									"         pm.expect(pm.response.code).to.be.oneOf([400, 401]);\r",
									"     });\r",
									"\r",
									"     // Test: Response contains error message\r",
									"     pm.test(\"Response contains error message\", function () {\r",
									"         var jsonData = pm.response.json();\r",
									"         pm.expect(jsonData).to.have.property('error');\r",
									"         // OR\r",
									"         // pm.expect(jsonData.success).to.be.false;\r",
									"     });\r",
									"\r",
									"     // Test: No token should be returned\r",
									"     pm.test(\"No authentication token returned\", function () {\r",
									"         var jsonData = pm.response.json();\r",
									"         pm.expect(jsonData.token).to.be.undefined;\r",
									"     });"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50219237-27087d6d-80bc-4153-81d1-a616e8ca35ad",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"username\": \"{{invalidUsername}}\",\r\n    \"password\": \"{{invalidPassword}}\"\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/api/account/authenticate",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"api",
								"account",
								"authenticate"
							]
						}
					},
					"response": []
				}
			],
			"id": "50219237-ad7fd777-508a-4bf8-8b46-61421c0f3217"
		},
		{
			"name": "Customer Management",
			"item": [
				{
					"name": "Add Customer",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "9f7ed98d-a655-4320-ae07-50933f030f7f",
								"exec": [
									"pm.test(\"Status code is 201 or 200\", function () {\r",
									"         pm.expect(pm.response.code).to.be.oneOf([200, 201]);\r",
									"     });\r",
									"\r",
									"     // Test: Response time check\r",
									"     pm.test(\"Response time is less than 2000ms\", function () {\r",
									"         pm.expect(pm.response.responseTime).to.be.below(2000);\r",
									"     });\r",
									"\r",
									"     // Test: Customer created successfully\r",
									"     pm.test(\"Customer created successfully\", function () {\r",
									"         var jsonData = pm.response.json();\r",
									"         pm.expect(jsonData.success).to.be.true;\r",
									"         // OR\r",
									"         // pm.expect(jsonData).to.have.property('customerId');\r",
									"     });\r",
									"\r",
									"     // Test: Response contains customer data\r",
									"     pm.test(\"Response contains customer details\", function () {\r",
									"         var jsonData = pm.response.json();\r",
									"         pm.expect(jsonData).to.have.property('data');\r",
									"         pm.expect(jsonData.data).to.have.property('name');\r",
									"     });"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50219237-5dea2952-7530-41e1-9df2-f6b842ceeacf",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "username",
									"value": "9519519519",
									"type": "string"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "// {\r\n//        \"name\": \"Abhishek Test\",\r\n//        \"email\": \"Abhishek@example.com\",\r\n//        \"mobile\": \"9876543210\",\r\n//        \"address\": \"123 Main Street, Mumbai\",\r\n//        \"city\": \"Mumbai\",\r\n//        \"state\": \"Maharashtra\",\r\n//        \"pincode\": \"407001\"\r\n// }\r\n\r\n\r\n{\r\n    \"LeadId\":0,\r\n    \"LeadName\":\"sushil2 testing2\",\r\n    \"RefNo\":\"\",\r\n    \"ReferredBy\":0,\r\n    \"PersonName\":\"\",\r\n    \"MobileNo\":\"\",\r\n    \"ContactNo\":\"\",\r\n    \"Email\":\"\",\"PersonDesignation\":\"\",\"Address\":\"\",\"CountryId\":0,\"StateId\":0,\"CityId\":0,\"LocalityId\":0,\"PinCode\":\"\",\"LeadSourceId\":0,\"LeadStageId\":0,\"TerritoryId\":0,\"Website\":\"\",\"OtherInfo\":\"\",\"LeadTypeId\":0,\"ParentLeadId\":0,\"IsVisibleToAll\":false,\"LeadContacts\":[],\"CustomFieldValues\":[],\"Latitude\":0,\"Longitude\":0,\"FrontView\":\"\",\"BackView\":\"\"}\r\n",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/api/CRM/AddLead",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"api",
								"CRM",
								"AddLead"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get All Customers",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "bdf49acc-34c9-4543-97ab-fb31ff2cc12a",
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"       pm.response.to.have.status(200);\r",
									"   });\r",
									"\r",
									"   pm.test(\"Response is an array or contains data\", function () {\r",
									"       var jsonData = pm.response.json();\r",
									"       pm.expect(jsonData).to.be.an('array').or.to.have.property('data');\r",
									"   });"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50219237-c517fba2-f765-4161-8c46-41c1ffdd5faa",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "username",
									"value": "9519519519",
									"type": "string"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"CityId\":0,\"CountryId\":0,\"From\":1,\"LeadSourceIds\":\"\",\"LeadStageIds\":\"\",\"LeadTypeIds\":\"\",\"LocalityIds\":\"\",\"StateId\":0,\"StatusIds\":\"\",\"TagIds\":\"\",\"TerritoryIds\":\"\",\"Text\":\"\",\"To\":30,\"UserIds\":\"\",\"ReferBy\":\"\",\"FromDate\":\"\",\"ToDate\":\"\",\"DateType\":\"ModifiedDate\",\"CreatedByUserIds\":\"\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseURL}}/api/CRM/Leads",
							"host": [
								"{{baseURL}}"
							],
							"path": [
								"api",
								"CRM",
								"Leads"
							],
							"query": [
								{
									"key": "",
									"value": null,
									"type": "text",
									"disabled": true
								}
							]
						}
					},
					"response": []
				}
			],
			"id": "50219237-e6efc801-8ae6-4faf-aa03-0ffc58dfd832"
		}
	]
}